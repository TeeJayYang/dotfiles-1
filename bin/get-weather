#!/bin/sh

location=$(curl --silent ipinfo.io/loc)
latitude=$(echo "$location" | cut --delimiter=',' --fields=1)
longitude=$(echo "$location" | cut --delimiter=',' --fields=2)
api_endpoint="http://api.openweathermap.org/data/2.5/weather?lat=$latitude&lon=$longitude&APPID=fc3cf768e2ea4f683adac8f074a036c6&units=metric"
resp=$(curl --silent "$api_endpoint")
weather=$(echo "$resp" | jq --raw-output '.weather[0].main')
temp=$(echo "$resp" | jq --raw-output '.main.temp')

if [ -z "$weather" ] && [ -z "$temp" ]; then
  echo "N/A"
else
  echo "$weather $tempÂ°C"
fi
